from graspnetAPI import GraspNetEval
import numpy as np
ge = GraspNetEval(root="/home/ma/dataset/graspnet", camera="realsense", split='test')

res, ap = ge.eval_seen("logs/contrastive/dump_trlight_addstage1_w_pretrain", proc=32)
print("seen")
print("AP",np.mean(res))
print(res.shape)
res = res.transpose(3,0,1,2).reshape(6,-1)
res = np.mean(res,axis=1)
print("AP0.4",res[1])
print("AP0.8",res[3])
#save_dir = os.path.join(cfgs.dump_dir, 'ap_{}.npy'.format(cfgs.camera))
#np.save(save_dir, res)
res, ap = ge.eval_similar("logs/contrastive/dump_trlight_addstage1_w_pretrain", proc=32)
print("similar")
print("AP",np.mean(res))
res = res.transpose(3,0,1,2).reshape(6,-1)
res = np.mean(res,axis=1)
print("AP0.4",res[1])
print("AP0.8",res[3])
res, ap = ge.eval_novel("logs/contrastive/dump_trlight_addstage1_w_pretrain", proc=32)
print("novel")
print("AP",np.mean(res))
res = res.transpose(3,0,1,2).reshape(6,-1)
res = np.mean(res,axis=1)
print("AP0.4",res[1])
print("AP0.8",res[3])